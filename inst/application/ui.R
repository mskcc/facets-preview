
#' helper function for app
#'
#' @return runs ui
#' @export ui
#' @importFrom shinyWidgets radioGroupButtons
#' @importFrom DT datatable
#' @import shinyjs 
fluidPage(
   shinyjs::useShinyjs(),
    navbarPage(
      "FACETS Preview",
      id="navbarPage1",
      tabPanel("Load Samples",
               value="tabPanel_sampleInput",
               mainPanel(
                 shinyjs::hidden(
                   wellPanel(id = "wellPanel_mountFail", 
                             style = "background-color: white; border-color: white; ",
                             HTML(
                               paste0("<div style=\"font-size: 16px; font-family: georgia; color: red; display: inline-block\">
                                      <i class=\"fa fa-exclamation-triangle\" aria-hidden=\"true\"></i><strong> /ifs/ not mounted. Nothing is gonna work!  </strong></div>")
                             ),
                             actionButton("button_mountFailRefresh", "Check for mount again", icon = icon("refresh"))
                             
                   )
                 ),
                 HTML( 
                   "<div style=\"background-color: #EEEEEE; padding: 20px;font-size: 16px; \">
                   <strong>USAGE</strong> <br> Enter facets output directory for 
                   each of the samples to be reviewed. This facets output directory is of the standard format generated by 
                   cmoflow_facets. The directory should have the counts file as well as the one or many run directories 
                   (eg: facets_c50p100R0.5.6, etc)</div><br>"
                 ),
                 wellPanel(
                   h4("Paste facets run directories"),
                   h5("Eg: /ifs/res/taylorlab/bandlamc/facets_review_app/test_data/P-0009137-T01-IM5_P-0009137-N01-IM5"),
                   textAreaInput("textAreaInput_samplesInput", label=NA, value="", rows=4),
                   actionButton("button_samplesInput", "Retrieve Sample(s)", class = "btn-primary")
                 ),
                 h3("or",style="text-align:center"),
                 wellPanel(
                   h4("Load facets runs from file"),
                   h5("file containing list of directories. Eg: /ifs/res/taylorlab/bandlamc/facets_review_app/test_input"),
                   textInput("textInput_filename", ""),
                   actionButton("button_fileInput", "Retrieve Sample(s) from file", class = "btn-primary")
                 ),
                 width = 12
                 )
      ),
      tabPanel("Samples Manifest",
               value="tabPanel_samplesManifest",
               mainPanel(
                 DT::dataTableOutput("datatable_samples"),
                 width=12
               )
      ),
      tabPanel("Review Fits",
               value="tabPanel_reviewFits",
               fluidRow( 
                 column(3, 
                        wellPanel(
                          h4(strong("Select fit:")),
                          selectInput(inputId = "selectInput_selectFit", label=NA,
                                      choices=c("Not selected")), 
                          style = "padding: 10px; "
                        ),
                        wellPanel(
                          h4(strong("Select run: ")),
                          shinyWidgets::radioGroupButtons(inputId = "radioGroupButton_fitType", 
                                                          choices = c("Purity", "Hisens"),
                                                          selected="Hisens", 
                                                          status = "primary",size = 'normal', width='100%',justified = TRUE),
                          actionButton("button_copyClipPath", "Copy path to clipboard", 
                                       icon = icon("clipboard"), 
                                       style="height:28px;font-size:8pt;vertical-align: middle; color:darkblue"),
                          h5(em('run parameters')),
                          verbatimTextOutput("verbatimTextOutput_runParams",placeholder = TRUE),
                          h5(em("alternate dipLogR")),
                          verbatimTextOutput("verbatimTextOutput_altBalLogR", placeholder = TRUE),
                          style = "padding: 10px; "
                        ),
                        wellPanel(
                          h4(strong("Generate a new fit:")),
                          shinyjs::hidden(div(id="div_watcherSuccess", 
                                              HTML(" Watcher status: <i class=\"fa fa-check\" aria-hidden=\"true\"></i>"), style="color: green")),
                          shinyjs::hidden(div(id="div_watcherFail", 
                                              HTML(" Watcher status: <i class=\"fa fa-times\" aria-hidden=\"true\"></i>"), style="color: red")),
                          textInput("textInput_newDipLogR", "dipLogR "),
                          textInput("textInput_newCval", "cval "),
                          
                          actionButton("button_refit", "Run", class = "btn-primary", width = '100%'),
                          tags$small(paste0(
                            "Note: Click 'Run' to submit re-fit job onto luna.  Takes upto a min for the job to finish."
                          )),
                          style = "padding: 10px; "
                        )
                 ),
                 column(9,
                        mainPanel(
                          tabsetPanel(
                            tabPanel("PNG image", imageOutput("imageOutput_pngImage1")),
                            tabPanel("Segments", mainPanel(DT::dataTableOutput("datatable_cncf"), width=12)),
                            tabPanel("Review notes",
                                     wellPanel(
                                       h4(strong("Review status:")),
                                       radioButtons("radioButtons_reviewStatus", label=NA,
                                                          c("Not Reviewed" = "not_reviewed",
                                                            "No fit available" = "reviewed_no_fit",
                                                            "Best fit available" = "reviewed_best_fit"), 
                                                    inline=TRUE, 
                                                    selected = "not_reviewed"),
                                       conditionalPanel(
                                         condition = "input.radioButtons_reviewStatus == 'reviewed_best_fit'",
                                         h4(strong("Select best fit (applicable only if best fit selected):")),
                                         selectInput(inputId = "selectInput_selectBestFit", label=NA,
                                                     choices=c("Not selected"))
                                       ),
                                       h4(strong("Review Notes:")),
                                       textAreaInput("textAreaInput_reviewNote", label=NA, value="", rows=4),
                                       textInput("textInput_signAs", label = "Reviewed by: "),
                                       actionButton("button_addReview", "Submit Review", class = "btn-primary", width='100%')
                                       ),
                                     wellPanel(
                                       h4(strong("Review History")),
                                       DT::dataTableOutput("datatable_reviewHistory")
                                     )
                                  )
                          ),width = '100%'
                      )
               )
      )
    )
  )
)
